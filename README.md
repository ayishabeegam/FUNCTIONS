# FUNCTIONS
CREATE DATABASE FUNCTIONS;
USE FUNCTIONS;
CREATE TABLE COUNTRY(Id INT PRIMARY KEY, Country_name VARCHAR(30),Population INT NOT NULL,Area VARCHAR(50));
CREATE TABLE PERSONS(Id INT PRIMARY KEY,F_name VARCHAR(30), L_name VARCHAR(30),Population INT,Rating INT CHECK(RATING<=10) ,Country_id INT, Country_name VARCHAR(30));
INSERT INTO COUNTRY VALUES(1,'CANADA',1000000,'ALBERTA');
INSERT INTO COUNTRY VALUES(2,'INDIA',1100000,'DELHI');
INSERT INTO COUNTRY VALUES(3,'CANADA',1200000,'ALBERTASASKATCHEWAN');
INSERT INTO COUNTRY VALUES(4,'USA',800000,'CALIFORNIA');
INSERT INTO COUNTRY VALUES(5,'AFGANISTAN',900000,'KHOST');
INSERT INTO COUNTRY VALUES(6,'BRAZIL',400000,'SALVADOR');
INSERT INTO COUNTRY VALUES(7,'CHILE',2200000,'SANTIAGO');
INSERT INTO COUNTRY VALUES(8,'DENMARK',1800000,'RIBE');
INSERT INTO COUNTRY VALUES(9,'ARGENTINA',5000000,'MENDOZA');
INSERT INTO COUNTRY VALUES(10,'SRILANKA',6000000,'MENOZA');


INSERT INTO PERSONS VALUES(11,'HALEEMA','ANAF',1000000,5,1,'CANADA');
INSERT INTO PERSONS VALUES(12,'AYISHA','BEEGAM',1000000,6,1,'CANADA');
INSERT INTO PERSONS VALUES(13,'NYNA','FASIL',900000,8,5,'AFGANISTAN');
INSERT INTO PERSONS VALUES(14,'MANJU','SUNIL',800000,3,4,'USA');
INSERT INTO PERSONS VALUES(15,'NAYAN','THARA',1100000,9,2,'INDIA');
INSERT INTO PERSONS VALUES(16,'THAS','LEENA',1100000,8,2,'INDIA');
INSERT INTO PERSONS VALUES(17,'NYHA','FAZY',400000,2,6,'BRAZIL');
INSERT INTO PERSONS VALUES(18,'SHERIN','JAHANA',2200000,6,7,'CHILE');
INSERT INTO PERSONS VALUES(19,'JASMIN','MOOSA',400000,5,6,'BRAZIL');
INSERT INTO PERSONS VALUES(20,'PRITHVI','SUKU',1000000,7,8,'DENMARK');
INSERT INTO PERSONS VALUES(21,'ALAN','DAVID',1000000,3,9,'ARGENTINA');
INSERT INTO PERSONS VALUES(22,'RAZIN','RAHMAN',1200000,5,3,'CANADA');
INSERT INTO PERSONS VALUES(23,'RAFIN','MUHD',1000000,5,1,'');
INSERT INTO PERSONS VALUES(24,'SHAHANA','SALIM',1000000,5,1,'');
INSERT INTO PERSONS VALUES(25,'LISHA','BIBIN',1000000,5,10,'UK');
INSERT INTO PERSONS VALUES(26,'HIJLA','ILYAS',1000000,5,10,'UK');
INSERT INTO PERSONS VALUES(27,'HIJ','YAS',900000,7.8,10,'UK');
INSERT INTO PERSONS VALUES(28,'JLA','AS',600000,7.3,10,'UK');

ALTER TABLE PERSONS ADD COLUMN AGE INT;

#ADD A NEW COLUMN CALLED DOB IN PERSONS TABLE WITH DATATYPE AS DATE
ALTER TABLE PERSONS ADD COLUMN DOB DATE;
UPDATE PERSONS SET DOB='1990-01-20' WHERE Id=11;
UPDATE PERSONS SET DOB='1991-02-22' WHERE Id=12;
UPDATE PERSONS SET DOB='1992-03-2' WHERE Id=13;
UPDATE PERSONS SET DOB='1993-04-27' WHERE Id=14;
UPDATE PERSONS SET DOB='1994-06-5' WHERE Id=15;
UPDATE PERSONS SET DOB='1995-07-10' WHERE Id=16;
UPDATE PERSONS SET DOB='1996-08-30' WHERE Id=17;
UPDATE PERSONS SET DOB='1993-01-20' WHERE Id=18;
UPDATE PERSONS SET DOB='1994-08-20' WHERE Id=19;
UPDATE PERSONS SET DOB='1999-09-11' WHERE Id=20;
UPDATE PERSONS SET DOB='1980-01-12' WHERE Id=21;
UPDATE PERSONS SET DOB='1982-09-13' WHERE Id=22;
UPDATE PERSONS SET DOB='1984-10-20' WHERE Id=23;
UPDATE PERSONS SET DOB='1985-11-11' WHERE Id=24;
UPDATE PERSONS SET DOB='1986-12-12' WHERE Id=25;
UPDATE PERSONS SET DOB='1987-08-13' WHERE Id=26;
UPDATE PERSONS SET DOB='1988-01-20' WHERE Id=27;
UPDATE PERSONS SET DOB='1989-03-03' WHERE Id=28;
SELECT * FROM PERSONS;

#WRITE A USER DEFINED FUNCTION TO CALCULATE AGE
DELIMITER $$
CREATE FUNCTION func_age3(DOB DATE)
RETURNS INT 
DETERMINISTIC
BEGIN
DECLARE AGE INT;
SET AGE=YEAR(CURDATE())-YEAR(DOB);
RETURN AGE;
END $$
DELIMITER ;

#WRITE A QUERY TO FETCH THE AGE OF ALL PERSONS USING THE FUNCTION THAT HAS BEEN CREATED
SELECT func_age3(DOB) AS AGE FROM PERSONS;

#FING THE LENGTH OF EACH COUNTRY NAME IN THE COUNTRY TABLE
SELECT LENGTH(Country_name) FROM COUNTRY;

#EXTRACT THE FIRST THREE CHARACTERS OF EACH COUNTRY'S NAME IN THE COUNTRY TABLE
SELECT SUBSTR(Country_name,1,3) FROM COUNTRY;

#CONVERT ALL COUNTRY NAMES TO UPPERCASE AND LOWER CASE IN THE COUNTRY TABLE
SELECT UPPER(Country_name) AS UPPER FROM COUNTRY;

SELECT LOWER(Country_name) AS LOWER FROM COUNTRY;





 
